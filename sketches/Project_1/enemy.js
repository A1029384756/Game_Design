class Enemy extends GameObject {
  /** @param {Vec2} pos 
   *  @param sprite
   */
  constructor(pos, sprite = createImage(0, 0)) {
    super(pos)
    this.vel = new Vec2(random(-0.5, 0.5) * 3, random(-0.5, 0.5) * 3)
    this.collider = new Collider(pos, 30)
    this.sprite = sprite
  }

  update() {
    super.update()

    this.pos.x += this.vel.x
    this.pos.y += this.vel.y
    this.collider.pos = this.pos

    // Screen border collission
    if ((this.pos.x < 15) || (this.pos.x > PANE_WIDTH - 15)) {
      this.vel.x = -this.vel.x
    }

    if ((this.pos.y < 15) || (this.pos.y > PANE_HEIGHT - 15)) {
      this.vel.y = -this.vel.y
    }

    if (random() > 0.99 && this.pos.y < PANE_HEIGHT / 2 && this.vel.y < 1) {
      game.objects.push(
        new Bomb(
          new Vec2(this.pos.x, this.pos.y + 24),
          new Vec2(0, 1),
          game.bomb_sprite,
          2
        )
      )
    }
  }

  draw() {
    image(this.sprite, this.pos.x - this.sprite.width / 2, this.pos.y - this.sprite.width / 2)
  }
}

function create_enemy_sprite() {
  let buf = createGraphics(32, 32)
  buf.noStroke()
  buf.fill('rgba(243,159,9,255)')
  buf.rect(14, 0, 2, 2)
  buf.fill('rgba(243,159,9,255)')
  buf.rect(16, 0, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(12, 2, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(14, 2, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(16, 2, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(18, 2, 2, 2)
  buf.fill('rgba(243,159,9,255)')
  buf.rect(4, 4, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(12, 4, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(14, 4, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(16, 4, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(18, 4, 2, 2)
  buf.fill('rgba(243,159,9,255)')
  buf.rect(26, 4, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(2, 6, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(4, 6, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(6, 6, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(12, 6, 2, 2)
  buf.fill('rgba(115,107,54,255)')
  buf.rect(14, 6, 2, 2)
  buf.fill('rgba(115,107,54,255)')
  buf.rect(16, 6, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(18, 6, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(24, 6, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(26, 6, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(28, 6, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(2, 8, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(4, 8, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(6, 8, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(8, 8, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(10, 8, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(12, 8, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(14, 8, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(16, 8, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(18, 8, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(20, 8, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(22, 8, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(24, 8, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(26, 8, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(28, 8, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(2, 10, 2, 2)
  buf.fill('rgba(115,107,54,255)')
  buf.rect(4, 10, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(6, 10, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(8, 10, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(10, 10, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(12, 10, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(14, 10, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(16, 10, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(18, 10, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(20, 10, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(22, 10, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(24, 10, 2, 2)
  buf.fill('rgba(115,107,54,255)')
  buf.rect(26, 10, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(28, 10, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(2, 12, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(4, 12, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(6, 12, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(8, 12, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(10, 12, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(12, 12, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(14, 12, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(16, 12, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(18, 12, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(20, 12, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(22, 12, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(24, 12, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(26, 12, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(28, 12, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(2, 14, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(4, 14, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(6, 14, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(12, 14, 2, 2)
  buf.fill('rgba(115,107,54,255)')
  buf.rect(14, 14, 2, 2)
  buf.fill('rgba(115,107,54,255)')
  buf.rect(16, 14, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(18, 14, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(24, 14, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(26, 14, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(28, 14, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(4, 16, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(12, 16, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(14, 16, 2, 2)
  buf.fill('rgba(136,132,132,255)')
  buf.rect(16, 16, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(18, 16, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(26, 16, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(4, 18, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(8, 18, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(10, 18, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(12, 18, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(14, 18, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(16, 18, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(18, 18, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(20, 18, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(22, 18, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(26, 18, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(8, 20, 2, 2)
  buf.fill('rgba(115,107,54,255)')
  buf.rect(10, 20, 2, 2)
  buf.fill('rgba(115,107,54,255)')
  buf.rect(12, 20, 2, 2)
  buf.fill('rgba(115,107,54,255)')
  buf.rect(14, 20, 2, 2)
  buf.fill('rgba(115,107,54,255)')
  buf.rect(16, 20, 2, 2)
  buf.fill('rgba(115,107,54,255)')
  buf.rect(18, 20, 2, 2)
  buf.fill('rgba(115,107,54,255)')
  buf.rect(20, 20, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(22, 20, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(8, 22, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(10, 22, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(12, 22, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(14, 22, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(16, 22, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(18, 22, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(20, 22, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(22, 22, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(10, 24, 2, 2)
  buf.fill('rgba(159,235,227,255)')
  buf.rect(12, 24, 2, 2)
  buf.fill('rgba(159,235,227,255)')
  buf.rect(14, 24, 2, 2)
  buf.fill('rgba(201,222,220,255)')
  buf.rect(16, 24, 2, 2)
  buf.fill('rgba(159,235,227,255)')
  buf.rect(18, 24, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(20, 24, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(10, 26, 2, 2)
  buf.fill('rgba(159,235,227,255)')
  buf.rect(12, 26, 2, 2)
  buf.fill('rgba(201,222,220,255)')
  buf.rect(14, 26, 2, 2)
  buf.fill('rgba(159,235,227,255)')
  buf.rect(16, 26, 2, 2)
  buf.fill('rgba(159,235,227,255)')
  buf.rect(18, 26, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(20, 26, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(12, 28, 2, 2)
  buf.fill('rgba(159,235,227,255)')
  buf.rect(14, 28, 2, 2)
  buf.fill('rgba(159,235,227,255)')
  buf.rect(16, 28, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(18, 28, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(14, 30, 2, 2)
  buf.fill('rgba(0,0,0,255)')
  buf.rect(16, 30, 2, 2)
  return buf.get(0, 0, buf.width, buf.height)
}
